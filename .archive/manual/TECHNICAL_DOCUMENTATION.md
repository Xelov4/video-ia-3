# Documentation ComplÃ¨te de VideoIA.net

## ðŸ“‹ Table des MatiÃ¨res
1. [Introduction](#introduction)
2. [Architecture Technique](#architecture-technique)
3. [Structure du Projet](#structure-du-projet)
4. [Base de DonnÃ©es](#base-de-donnÃ©es)
5. [Internationalisation](#internationalisation)
6. [Composants Principaux](#composants-principaux)
7. [Services](#services)
8. [API Routes](#api-routes)
9. [DÃ©ploiement](#dÃ©ploiement)
10. [ProblÃ¨mes Connus et Solutions](#problÃ¨mes-connus-et-solutions)
11. [Maintenance](#maintenance)

## Introduction

VideoIA.net est un rÃ©pertoire complet d'outils d'intelligence artificielle spÃ©cialisÃ© dans la crÃ©ation vidÃ©o, le contenu, l'automatisation et plus encore. Le site prÃ©sente plus de 16 765 outils IA organisÃ©s en 140 catÃ©gories et traduits en 7 langues.

### Objectifs du Projet
- Fournir un catalogue complet et Ã  jour des outils IA
- Offrir une expÃ©rience utilisateur multilingue fluide
- Permettre une recherche et un filtrage avancÃ©s des outils
- PrÃ©senter des informations dÃ©taillÃ©es sur chaque outil

## Architecture Technique

### Stack Technologique
- **Frontend**: Next.js 15 avec App Router
- **Backend**: API Routes Next.js
- **Base de DonnÃ©es**: PostgreSQL 16.9
- **ORM**: Prisma
- **Styles**: TailwindCSS
- **Authentification**: NextAuth
- **Internationalisation**: i18n natif de Next.js avec middleware
- **HÃ©bergement**: Serveur Ubuntu local

### Diagramme d'Architecture
```
+------------------+     +------------------+     +------------------+
|                  |     |                  |     |                  |
|  Client Browser  | <-> |  Next.js Server  | <-> |  PostgreSQL DB   |
|                  |     |                  |     |                  |
+------------------+     +------------------+     +------------------+
                               |
                               v
                         +------------------+
                         |                  |
                         |  File System     |
                         |  (images, etc.)  |
                         |                  |
                         +------------------+
```

## Structure du Projet

```
video-ia.net/
â”œâ”€â”€ app/                      # App Router structure
â”‚   â”œâ”€â”€ [lang]/               # Routes multilingues
â”‚   â”‚   â”œâ”€â”€ page.tsx          # Page d'accueil
â”‚   â”‚   â”œâ”€â”€ categories/       # Pages des catÃ©gories
â”‚   â”‚   â”œâ”€â”€ tools/            # Pages des outils
â”‚   â”‚   â””â”€â”€ layout.tsx        # Layout principal
â”‚   â”œâ”€â”€ admin/                # Interface d'administration
â”‚   â””â”€â”€ api/                  # Routes API
â”œâ”€â”€ prisma/                   # Configuration Prisma
â”‚   â””â”€â”€ schema.prisma         # SchÃ©ma de base de donnÃ©es
â”œâ”€â”€ public/                   # Assets statiques
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ components/           # Composants React
â”‚   â”‚   â”œâ”€â”€ layout/           # Composants de mise en page
â”‚   â”‚   â”œâ”€â”€ tools/            # Composants liÃ©s aux outils
â”‚   â”‚   â””â”€â”€ ui/               # Composants UI rÃ©utilisables
â”‚   â”œâ”€â”€ hooks/                # Hooks personnalisÃ©s
â”‚   â””â”€â”€ lib/                  # BibliothÃ¨ques et utilitaires
â”‚       â”œâ”€â”€ auth/             # Configuration d'authentification
â”‚       â”œâ”€â”€ database/         # Services de base de donnÃ©es
â”‚       â”‚   â”œâ”€â”€ client.ts     # Client Prisma
â”‚       â”‚   â””â”€â”€ services/     # Services d'accÃ¨s aux donnÃ©es
â”‚       â”œâ”€â”€ i18n/             # Configuration internationalisation
â”‚       â””â”€â”€ services/         # Services mÃ©tier
â”œâ”€â”€ middleware.ts             # Middleware Next.js (i18n, auth)
â”œâ”€â”€ next.config.js            # Configuration Next.js
â””â”€â”€ package.json              # DÃ©pendances npm
```

## Base de DonnÃ©es

### Configuration
- **Nom de la BD**: `video_ia_net`
- **Utilisateur**: `video_ia_user`
- **Mot de passe**: `video123`
- **HÃ´te**: `localhost`
- **Port**: `5432`

### SchÃ©ma Principal
La base de donnÃ©es contient plusieurs tables principales :

#### Tools
Table principale contenant les 16 765 outils IA.

```prisma
model Tool {
  id                String            @id @default(uuid())
  name              String            @db.VarChar(255)
  slug              String            @unique @db.VarChar(255)
  description       String?           @db.Text
  overview          String?           @db.Text
  url               String            @db.VarChar(255)
  image_url         String?           @db.VarChar(255)
  video_url         String?           @db.VarChar(255)
  tool_category     String?           @db.VarChar(100)
  pricing_type      String?           @db.VarChar(50)
  pricing_url       String?           @db.VarChar(255)
  target_audience   String?           @db.Text
  use_cases         String?           @db.Text
  key_features      String?           @db.Text
  tags              String?           @db.Text
  quality_score     Decimal?          @db.Decimal(3, 1)
  view_count        Int               @default(0)
  is_active         Boolean           @default(true)
  is_featured       Boolean           @default(false)
  created_at        DateTime          @default(now())
  updated_at        DateTime          @updatedAt
  translations      ToolTranslation[]
}
```

#### Categories
Table des 140 catÃ©gories d'outils.

```prisma
model Category {
  id           String                @id @default(uuid())
  name         String                @db.VarChar(100)
  slug         String                @unique @db.VarChar(100)
  description  String?               @db.Text
  icon_name    String?               @db.VarChar(50)
  tool_count   Int                   @default(0)
  is_featured  Boolean               @default(false)
  created_at   DateTime              @default(now())
  translations CategoryTranslation[]
}
```

#### Traductions
Tables pour stocker les traductions des outils et catÃ©gories.

```prisma
model ToolTranslation {
  id               String   @id @default(uuid())
  tool_id          String
  language_code    String   @db.VarChar(5)
  name             String   @db.VarChar(255)
  overview         String?  @db.Text
  description      String?  @db.Text
  meta_title       String?  @db.VarChar(255)
  meta_description String?  @db.Text
  translation_source String? @db.VarChar(50)
  quality_score    Decimal? @db.Decimal(3, 1)
  human_reviewed   Boolean  @default(false)
  created_at       DateTime @default(now())
  updated_at       DateTime @updatedAt
  tool             Tool     @relation(fields: [tool_id], references: [id], onDelete: Cascade)

  @@unique([tool_id, language_code])
}

model CategoryTranslation {
  id               String   @id @default(uuid())
  category_id      String
  language_code    String   @db.VarChar(5)
  name             String   @db.VarChar(100)
  description      String?  @db.Text
  translation_source String? @db.VarChar(50)
  quality_score    Decimal? @db.Decimal(3, 1)
  human_reviewed   Boolean  @default(false)
  created_at       DateTime @default(now())
  updated_at       DateTime @updatedAt
  category         Category @relation(fields: [category_id], references: [id], onDelete: Cascade)

  @@unique([category_id, language_code])
}
```

### AccÃ¨s Ã  la Base de DonnÃ©es
L'accÃ¨s Ã  la base de donnÃ©es se fait via Prisma ORM. Le client Prisma est initialisÃ© dans `src/lib/database/client.ts` :

```typescript
import { PrismaClient } from '@prisma/client'

// Singleton pattern pour Ã©viter les connexions multiples
declare global {
  var prisma: PrismaClient | undefined
}

export const prisma = global.prisma || new PrismaClient()

if (process.env.NODE_ENV !== 'production') {
  global.prisma = prisma
}
```

## Internationalisation

### Langues SupportÃ©es
- Anglais (en) - langue par dÃ©faut
- FranÃ§ais (fr)
- Italien (it)
- Espagnol (es)
- Allemand (de)
- NÃ©erlandais (nl)
- Portugais (pt)

### Configuration
L'internationalisation est gÃ©rÃ©e par un middleware Next.js qui intercepte les requÃªtes et redirige vers la langue appropriÃ©e. La configuration se trouve dans `middleware.ts`.

Les types et constantes i18n sont centralisÃ©s dans `src/lib/i18n/types.ts` :

```typescript
export type SupportedLanguage = 'en' | 'fr' | 'it' | 'es' | 'de' | 'nl' | 'pt'
export const SUPPORTED_LANGUAGES: SupportedLanguage[] = ['en', 'fr', 'it', 'es', 'de', 'nl', 'pt']
export const DEFAULT_LANGUAGE: SupportedLanguage = 'en'
```

Un contexte React est fourni dans `src/lib/i18n/context.tsx` pour accÃ©der Ã  la langue courante dans les composants client.

## Composants Principaux

### Layout
- `ModernHeader.tsx` - En-tÃªte du site avec menu de navigation et mega menu
- `Footer.tsx` - Pied de page avec liens et informations lÃ©gales

### Outils
- `ToolCard.tsx` - Carte affichant un outil IA
- `ToolsGrid.tsx` - Grille d'outils avec pagination
- `ToolList.tsx` - Affichage des outils en mode liste
- `AdvancedFilters.tsx` - Filtres de recherche avancÃ©s

### Pages
- `app/[lang]/page.tsx` - Page d'accueil
- `app/[lang]/tools/page.tsx` - Page de recherche d'outils
- `app/[lang]/tools/[slug]/page.tsx` - Page dÃ©taillÃ©e d'un outil
- `app/[lang]/categories/page.tsx` - Page listant toutes les catÃ©gories
- `app/[lang]/categories/[slug]/page.tsx` - Page d'une catÃ©gorie spÃ©cifique

## Services

### Services de Base de DonnÃ©es
- `src/lib/database/services/tools.ts` - Service CRUD pour les outils
- `src/lib/database/services/categories.ts` - Service CRUD pour les catÃ©gories
- `src/lib/database/services/multilingual-tools.ts` - Service pour les outils multilingues
- `src/lib/database/services/multilingual-categories.ts` - Service pour les catÃ©gories multilingues

### Services MÃ©tier
- `src/lib/services/dataExtraction.ts` - Extraction de donnÃ©es structurÃ©es (audiences, cas d'usage)
- `src/lib/services/emojiMapping.ts` - Mapping des catÃ©gories vers des emojis

## API Routes

### Routes Principales
- `/api/tools` - CRUD des outils
- `/api/categories` - CRUD des catÃ©gories
- `/api/data-extraction` - Extraction de donnÃ©es (audiences, cas d'usage)
- `/api/search` - Recherche avancÃ©e d'outils

### Format de RÃ©ponse Standard
Toutes les API renvoient des rÃ©ponses au format suivant :

```typescript
{
  success: boolean,
  data: any,
  error?: string,
  meta?: {
    queryTime?: number,
    language?: string,
    fallbackCount?: number
  }
}
```

## DÃ©ploiement

### PrÃ©requis
- Node.js 18+
- PostgreSQL 16+
- npm ou yarn

### Installation
1. Cloner le dÃ©pÃ´t
2. Installer les dÃ©pendances : `npm install`
3. Configurer les variables d'environnement dans `.env.local`
4. ExÃ©cuter les migrations Prisma : `npx prisma migrate deploy`
5. GÃ©nÃ©rer le client Prisma : `npx prisma generate`
6. Construire l'application : `npm run build`
7. DÃ©marrer le serveur : `npm start`

### Script de DÃ©ploiement
Un script de dÃ©ploiement est disponible dans `scripts/deploy.sh`. Il effectue les opÃ©rations suivantes :
- Mise Ã  jour des dÃ©pendances
- VÃ©rification des types
- Validation du linter
- VÃ©rification de la configuration
- Validation des migrations Prisma
- Construction de l'application
- RedÃ©marrage du serveur

## ProblÃ¨mes Connus et Solutions

### Erreurs Courantes

1. **Erreur: Cannot access 'ITEMS_PER_PAGE' before initialization**
   - **Solution**: La variable ITEMS_PER_PAGE doit Ãªtre dÃ©clarÃ©e avant son utilisation dans le fichier `app/[lang]/tools/ToolsPageClient.tsx`.

2. **Erreur: Only plain objects can be passed to Client Components from Server Components. Decimal objects are not supported.**
   - **Solution**: Utiliser la fonction `serializePrismaObject` dans `src/lib/utils/prismaHelpers.ts` pour convertir les objets Decimal en nombres JavaScript.

3. **Erreurs 404 pour les icÃ´nes et favicons**
   - **Solution**: CrÃ©er les fichiers manquants dans `public/` et `public/images/`.

4. **ProblÃ¨mes de dÃ©pendances circulaires dans les hooks React**
   - **Solution**: Utiliser des useEffects sÃ©parÃ©s et Ã©viter les dÃ©pendances circulaires dans les fonctions de rappel.

## Maintenance

### Mise Ã  Jour des DonnÃ©es
Les donnÃ©es des outils peuvent Ãªtre mises Ã  jour via l'interface d'administration ou par importation de fichiers CSV/JSON. Les scripts d'importation se trouvent dans le dossier `scripts/`.

### Backup de la Base de DonnÃ©es
Il est recommandÃ© de faire des sauvegardes rÃ©guliÃ¨res de la base de donnÃ©es :
```bash
pg_dump -U video_ia_user -d video_ia_net > backup_$(date +%Y%m%d).sql
```

### Monitoring
Le monitoring des performances peut Ãªtre effectuÃ© avec les outils suivants :
- Vercel Analytics (si dÃ©ployÃ© sur Vercel)
- New Relic ou Datadog pour le monitoring serveur
- Sentry pour le suivi des erreurs

### Logs
Les logs de l'application sont disponibles dans :
- Console du navigateur pour les erreurs cÃ´tÃ© client
- Logs du serveur Next.js pour les erreurs cÃ´tÃ© serveur
- Logs PostgreSQL pour les erreurs de base de donnÃ©es

---

## Ressources Additionnelles
- [Documentation Next.js](https://nextjs.org/docs)
- [Documentation Prisma](https://www.prisma.io/docs)
- [Documentation TailwindCSS](https://tailwindcss.com/docs)
- [Documentation PostgreSQL](https://www.postgresql.org/docs/)

---

*Ce document a Ã©tÃ© crÃ©Ã© pour faciliter la maintenance et le dÃ©veloppement continu de VideoIA.net. Pour toute question supplÃ©mentaire, veuillez contacter l'Ã©quipe de dÃ©veloppement.*
